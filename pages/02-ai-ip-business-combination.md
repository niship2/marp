---
marp: true
theme: default
paginate: true
backgroundColor: #fff
backgroundImage: url('https://marp.app/assets/hero-background.svg')
---

# 2. プロンプトエンジニアリングの基礎と実践

---

## 2-1. なぜ AI は思ったような答えを返してくれないのか？

#### AI の特性と限界の理解

**AI の基本的な動作原理**

- **統計的学習**: 大量データからパターンを学習
- **文脈依存**: 直前の会話や設定に影響される
- **曖昧性**: 不明確な指示では予測不可能な回答
- **知識の制限**: 学習データの範囲内でのみ回答可能

---

## 2-1. なぜ AI は思ったような答えを返してくれないのか？（続き）

#### よくある問題と原因

| 問題                 | 原因                     | 対策               |
| -------------------- | ------------------------ | ------------------ |
| **回答が抽象的**     | 指示が曖昧・具体的でない | 具体的な要件を明示 |
| **期待と異なる形式** | 出力形式の指定がない     | 明確な形式を指定   |

---

## 2-1. なぜ AI は思ったような答えを返してくれないのか？（2）

#### よくある問題と原因（続き）

| 問題             | 原因             | 対策           |
| ---------------- | ---------------- | -------------- |
| **情報が古い**   | 学習データの制限 | 最新情報の確認 |
| **一貫性がない** | 文脈の不足       | 背景情報の提供 |

---

## 2-1. なぜ AI は思ったような答えを返してくれないのか？（3）

#### AI の「思考プロセス」を理解する

**AI の回答生成プロセス**

```
1. 入力の解析 → 2. 文脈の理解 → 3. 知識の検索 → 4. 回答の生成
```

**効果的な指示のポイント**

- **明確性**: 何を求めているかが明確
- **具体性**: 具体的な要件や制約
- **構造化**: 段階的な指示や分類
- **制約**: 回答の範囲や形式の制限

---

## 2-1. なぜ AI は思ったような答えを返してくれないのか？（4）

#### プロンプト設計の重要性

**なぜプロンプト設計が重要か**

- **回答品質の向上**: 適切な指示で高品質な回答
- **効率性の向上**: 一度で期待する回答を得られる
- **一貫性の確保**: 同じような回答パターンの実現
- **コスト削減**: やり直しの削減

---

## 2-2. プロンプトエンジニアリングの基礎

#### プロンプトの基本構造

**効果的なプロンプトの構成要素**

```
1. 役割設定（Role）
2. 背景情報（Context）
3. 具体的な指示（Task）
4. 出力形式（Format）
5. 制約条件（Constraints）
```

---

## 2-2. プロンプトエンジニアリングの基礎（続き）

#### プロンプトの基本構造（続き）

**基本テンプレート**

```
役割: [AIの役割を明確に]
背景: [必要な背景情報]
指示: [具体的なタスク]
出力: [期待する形式]
制約: [制限事項や注意点]
```

---

## 2-2. プロンプトエンジニアリングの基礎（2）

#### プロンプト設計の基本原則

**Claude ベストプラクティスに基づく設計原則**

**1. 明確で直接的な表現を使用**

- 曖昧さを排除した具体的な指示
- 段階的な論理的構造
- 期待する出力形式の明示

---

## 2-2. プロンプトエンジニアリングの基礎（3）

#### プロンプト設計の基本原則（続き）

**2. 役割を与える（システムプロンプト）**

- AI の専門性・能力・制約を明確に定義
- 期待される行動パターンの設定

**3. 例を使用する（マルチショット）**

- 具体的な入力・出力例の提供
- 期待する品質レベルの明示

---

## 2-2. プロンプトエンジニアリングの基礎（4）

#### プロンプト設計の基本原則（2）

**4. 生成 AI に考えさせる（思考の連鎖 Chain of thought）**

- 段階的な思考プロセスの指示
- 根拠の明示を求める

**実践例**

```markdown
<role>
あなたは特許分析の専門家で、技術的詳細と法的観点の両方に精通しています。
正確で実用的な分析を提供することを専門としています。
</role>
```

---

## 2-2. プロンプトエンジニアリングの基礎（5）

#### 実践例（続き）

```markdown
<context>
特許文献の分析を行う必要があります。技術的新規性と実用性の評価が求められています。
</context>

<task>
以下の特許文献を分析し、技術的新規性と実用性を評価してください：
[特許文献の内容]

以下の観点で分析をお願いします：

1. 技術的新規性の評価
2. 実用性の評価
3. 先行技術との差別化ポイント
4. 改善提案
   </task>
```

---

## 2-2. プロンプトエンジニアリングの基礎（6）

#### 実践例（2）

```markdown
<output_format>
出力形式：

- 構造化された分析結果
- 具体的な根拠の明示
- 実用的な改善提案
- リスク評価
  </output_format>

<constraints>
制約：
- 客観的な評価
- 具体的な根拠
- 実用性を重視
- 法的妥当性の確保
</constraints>
```

---

## 2-3. 事例で学ぶ！プロンプトのブラッシュアップ体験 - 事例 1: 特許文献の要約

#### 初級レベル：基本的な指示

**改善前のプロンプト**

```
「この特許文献を要約してください」
```

**問題点**

- 何を要約すべきかが不明確
- 出力形式が指定されていない
- 要約の長さや詳細度が不明
- 特許特有の要素が考慮されていない

---

## 2-3. 事例で学ぶ！プロンプトのブラッシュアップ体験 - 事例 1: 特許文献の要約（続き）

#### 中級レベル：具体的な指示

**改善後のプロンプト**

```
「以下の特許文献を要約してください：

文献：[特許文献の内容]

以下の点に注目して要約をお願いします：
1. 発明の概要
2. 技術的課題
3. 解決手段
4. 効果

出力形式：箇条書きで簡潔に」
```

---

## 2-3. 事例で学ぶ！プロンプトのブラッシュアップ体験 - 事例 1: 特許文献の要約（2）

#### 上級レベル：構造化された指示

**さらに改善（第 2 段階）**

```markdown
<role>
あなたは特許分析の専門家で、特許文献の要約と分析を専門としています。
技術的詳細と法的観点の両方に精通し、実用的な分析を提供します。
</role>

<context>
特許文献の要約と分析を行う必要があります。
技術的新規性、実用性、先行技術との関係を正確に把握することが求められています。
</context>
```

---

## 2-3. 事例で学ぶ！プロンプトのブラッシュアップ体験 - 事例 1: 特許文献の要約（3）

#### 上級レベル：構造化された指示（続き）

```markdown
<task>
以下の特許文献を要約・分析してください：

文献内容：[特許文献の詳細]

以下の手順で段階的に分析してください：

1. まず、発明の概要を把握
2. 次に、技術的課題を特定
3. そして、解決手段を分析
4. 最後に、効果と新規性を評価
   </task>
```

---

## 2-3. 事例で学ぶ！プロンプトのブラッシュアップ体験 - 事例 1: 特許文献の要約（4）

#### 上級レベル：構造化された指示（2）

```markdown
<output_format>
出力形式：

- 構造化された要約
- 技術的詳細の整理
- 法的観点からの評価
- 実用性の分析
  </output_format>
```

---

```markdown
<constraints>
制約：
- 客観的な分析
- 具体的な根拠
- 特許法の観点
- 実用性の重視
</constraints>
```

---

## 2-4. 事例 2: 先行技術調査のキーワード抽出

#### 初級レベル：基本的な指示

**改善前のプロンプト**

```markdown
「キーワードを抽出してください」
```

**問題点**

- どのようなキーワードかが不明確
- 抽出する数が指定されていない
- 用途が不明確
- 優先順位が考慮されていない

---

## 2-4. 事例 2: 先行技術調査のキーワード抽出（続き）

#### 中級レベル：具体的な指示

**改善後のプロンプト**

```markdown
「以下の技術分野で先行技術調査に使用するキーワードを抽出してください：

技術分野：[分野名]
調査目的：[目的の詳細]

以下の観点でキーワードを抽出してください：

1. 技術用語
2. 関連技術
3. 応用分野
4. 競合技術

出力：各観点で 5 個ずつ、優先順位付き」
```

---

## 2-4. 事例 2: 先行技術調査のキーワード抽出（2）

#### 上級レベル：構造化された指示

**さらに改善（第 2 段階）**

```markdown
<role>
あなたは特許検索の専門家で、効率的な先行技術調査のためのキーワード設計を専門としています。
技術的深さと検索効率の両方を考慮した提案を提供します。
</role>

<context>
先行技術調査のためのキーワード抽出が必要です。
包括的で効率的な検索を実現するキーワードセットの設計が求められています。
</context>
```

---

## 2-4. 事例 2: 先行技術調査のキーワード抽出（3）

#### 上級レベル：構造化された指示（続き）

```markdown
<task>
以下の条件で先行技術調査用のキーワードを抽出してください：

技術分野：[分野の詳細]
調査目的：[目的の詳細]
検索範囲：[地理的・時間的範囲]

以下の手順で段階的に抽出してください：

1. まず、核心技術キーワードを特定
2. 次に、関連技術キーワードを抽出
3. そして、応用分野キーワードを追加
4. 最後に、検索式の組み合わせを提案
   </task>
```

---

## 2-4. 事例 2: 先行技術調査のキーワード抽出（4）

#### 上級レベル：構造化された指示（2）

```markdown
<output_format>
出力形式：

- 階層化されたキーワード
- 優先順位付きリスト
- 検索式の提案
- 効果予測
  </output_format>
```

---

```markdown
<constraints>
制約：
- 検索効率の最適化
- 網羅性の確保
- 実用性の重視
- 更新可能性の考慮
</constraints>
```

---

## 2-5. 事例 3: 明細書作成支援

#### 初級レベル：基本的な指示

**改善前のプロンプト**

```markdown
「明細書を作成してください」
```

**問題点**

- どの部分を作成すべきかが不明確
- 発明の詳細が提供されていない
- 出力形式が指定されていない
- 法的要件が考慮されていない

---

## 2-5. 事例 3: 明細書作成支援（続き）

#### 中級レベル：具体的な指示

**改善後のプロンプト**

```markdown
「以下の発明について明細書の背景技術部分を作成してください：

発明内容：[発明の概要]
技術分野：[分野名]
課題：[解決すべき問題]

以下の構成で作成してください：

1. 技術分野の説明
2. 先行技術の整理
3. 課題の明確化
4. 発明の必要性

出力形式：特許庁の要件に準拠」
```

---

## 2-5. 事例 3: 明細書作成支援（2）

#### 上級レベル：構造化された指示

**さらに改善（第 2 段階）**

```markdown
<role>
あなたは特許明細書作成の専門家で、特許法と技術的詳細の両方に精通しています。
法的妥当性と技術的精度を両立した明細書作成を専門としています。
</role>

<context>
特許明細書の作成支援が必要です。
法的要件を満たし、技術的詳細を正確に記載した明細書の作成が求められています。
</context>
```

---

## 2-5. 事例 3: 明細書作成支援（3）

#### 上級レベル：構造化された指示（続き）

```markdown
<task>
以下の発明について明細書を作成してください：

発明内容：[発明の詳細]
技術分野：[分野の詳細]
先行技術：[既存技術の状況]
課題：[解決すべき問題]
効果：[期待される効果]

以下の手順で段階的に作成してください：

1. まず、背景技術部分を作成
2. 次に、発明の概要を記載
3. そして、詳細な説明を追加
4. 最後に、実施例とクレームを記載
   </task>
```

---

## 2-5. 事例 3: 明細書作成支援（4）

#### 上級レベル：構造化された指示（2）

```markdown
<output_format>
出力形式：

- 特許庁要件準拠の構成
- 技術的詳細の記載
- 法的妥当性の確保
- 実用性の重視
  </output_format>

<constraints>
制約：
- 特許法の遵守
- 技術的精度
- 明確性の確保
- 実用性の重視
</constraints>
```

---

## 2-6. プロンプト改善の実践テクニック

#### Few-Shot Learning（少数例学習）

**活用方法**

```markdown
<examples>
入力例 1: 「AI技術の特許文献を要約してください」
出力例 1: 「発明の概要：機械学習による画像認識技術
技術的課題：従来技術の精度不足
解決手段：深層学習アルゴリズムの改良
効果：認識精度の 30%向上」

入力例 2: 「ブロックチェーン技術の特許を分析してください」
出力例 2: 「発明の概要：分散型台帳技術の改良
技術的課題：スケーラビリティの問題
解決手段：レイヤー 2 ソリューションの実装
効果：処理速度の 10 倍向上」
</examples>
```

---

## 2-6. プロンプト改善の実践テクニック（続き）

#### Few-Shot Learning（続き）

```markdown
<task>
上記の例を参考に、以下の特許文献を同様の形式で要約してください：
[新しい特許文献の内容]
</task>
```

---

## 2-6. プロンプト改善の実践テクニック（2）

#### Chain of Thought（思考の連鎖）

**活用方法**

```markdown
<thinking_process>
以下の手順で段階的に思考してください：

1. まず、問題を理解し、必要な情報を整理する
2. 次に、関連する知識や経験を検索する
3. そして、複数の解決策を検討する
4. 最後に、最適な解決策を選択し、根拠を明示する
   </thinking_process>
```

---

![Chain of Thought vs Tree of Thoughts](../img/img_02_01_chainogthought.png)
**図 1: Chain of Thought（左）と Tree of Thoughts（右）の比較**

---

## 2-6. プロンプト改善の実践テクニック（3）

#### Chain of Thought（続き）

```markdown
<problem>
「この特許技術の市場性を評価してください」

思考プロセス：

1. 技術の基本特性を理解
2. 市場の現状とトレンドを分析
3. 競合技術との比較
4. 市場参入の可能性を評価
5. リスクと機会を分析
6. 最終的な市場性評価を提示
   </problem>
```

---

## 2-6. プロンプト改善の実践テクニック（4）

#### ReAct（Reasoning and Acting）

**ReAct の概要**

ReAct は、言語モデルが推論（Reasoning）と行動（Acting）を組み合わせてタスクを遂行する手法です。

**基本概念**

- **推論（Reasoning）**: 問題を分析し、解決策を考える
- **行動（Acting）**: 適切なツールを使用して情報を収集・処理
- **反復**: 推論と行動を繰り返して最適解を見つける

---

## 2-6. プロンプト改善の実践テクニック（5）

#### ReAct（続き）

**ReAct の構造**

```markdown
1. 思考（Thought）: 現在の状況を分析し、次の行動を計画
2. 行動（Action）: 適切なツールを選択して実行
3. 観察（Observation）: 行動の結果を観察・記録
4. 反復: 目標達成まで 1-3 を繰り返す
```

---

<img src="../img/02_react_paper.png" width="100%">

[ReAct のもととなった論文](https://arxiv.org/abs/2210.03629)

---

![Basic ReAct](../img/img_02_02_ReAct.png)

**図 2: Basic ReAct のフローチャート**

---

**特許業務での活用例**

- **先行技術調査**: 検索ツールを使用した効率的な調査
- **特許分析**: 複数の情報源からの総合的な分析
- **明細書作成**: 技術情報の収集と構造化された文書作成

---

## 2-6. プロンプト改善の実践テクニック（6）

#### ReAct（2）

**ReAct の利点**

- **柔軟性**: 複雑な問題に対応可能
- **効率性**: 適切なツールの自動選択
- **透明性**: 思考プロセスの可視化
- **拡張性**: 新しいツールの追加が容易

---

**実装上の課題**

- **ツール選択の精度**: 適切なツールの選択が重要
- **一貫性の確保**: 複数回の実行での結果の安定性
- **エラーハンドリング**: ツール実行失敗時の対応

---

**ReAct の実践例**

```markdown
思考: 特許文献の先行技術調査が必要だ。まず検索ツールを使用して関連文献を探そう。
行動: 特許検索データベースでキーワード検索を実行
観察: 100 件の関連文献が見つかった
思考: 文献が多すぎる。絞り込み検索を行おう。
行動: より具体的なキーワードで再検索
観察: 20 件の関連文献に絞り込まれた
思考: これらの文献を分析して、最も関連性の高いものを特定しよう。
```

---

#### プロンプトの反復改善

**改善サイクル**

1. **初回実行**: 基本的なプロンプトで実行
2. **結果評価**: 出力の品質と期待値との差を分析
3. **問題特定**: 改善すべき点を特定
4. **プロンプト改善**: 具体的な改善を実施
5. **再実行**: 改善されたプロンプトで再実行
6. **継続改善**: 満足いく結果まで繰り返し

---

## 2-7. プロンプトの品質評価と改善

#### 評価基準の設定

**定量的評価指標**

- **関連性**: 回答が質問に関連しているか
- **正確性**: 技術的・法的に正確か
- **完全性**: 必要な情報が含まれているか
- **一貫性**: 複数回の実行で一貫した結果か
- **実用性**: 実際の業務で使用可能か

---

## 2-7. プロンプトの品質評価と改善（続き）

#### 評価基準の設定（続き）

**定性的評価指標**

- **明確性**: 回答が理解しやすいか
- **構造性**: 情報が整理されているか
- **創造性**: 新たな視点や洞察があるか
- **適切性**: 用途に適しているか

---

## 2-7. プロンプトの品質評価と改善（2）

#### 改善プロセス

**系統的な改善アプローチ**

1. **ベースライン設定**: 現在のプロンプトの性能を測定
2. **目標設定**: 改善すべき指標と目標値を設定
3. **改善実施**: コンテキスト設計の改善
4. **効果測定**: 改善効果を測定・評価
5. **継続改善**: さらなる改善を実施

---

## 2-8. プロンプトライブラリ

#### 特許調査テンプレート

```markdown
<role>
あなたは特許調査の専門家で、効率的で網羅的な調査を専門としています。
技術的深さと実用性を両立した調査方法を提供します。
</role>

<context>
特許調査の実施が必要です。包括的で効率的な調査方法の設計が求められています。
</context>
```

---

## 2-8. プロンプトライブラリ（続き）

#### 特許調査テンプレート（続き）

```markdown
<task>
以下の条件で特許調査を実施してください：

調査対象：[技術分野・企業名など]
調査目的：[目的の詳細]
調査期間：[期間の指定]
調査範囲：[地理的・技術的範囲]

以下の手順で段階的に調査してください：

1. まず、調査戦略を策定
2. 次に、検索式を設計
3. そして、文献を収集・分析
4. 最後に、結果を整理・評価
   </task>
```

---

## 2-8. プロンプトライブラリ（2）

#### 特許調査テンプレート（2）

```markdown
<output_format>
出力形式：

- 調査戦略の概要
- 検索式の詳細
- 収集文献の分析
- 調査結果の評価
- 今後の方針
  </output_format>

<constraints>
制約：
- 効率性の確保
- 網羅性の維持
- 実用性の重視
- 更新可能性の考慮
</constraints>
```

---

## 2-8. プロンプトライブラリ（3）

#### 明細書作成テンプレート

```markdown
<role>
あなたは特許明細書作成の専門家で、法的妥当性と技術的精度を両立した明細書作成を専門としています。
特許庁の要件を満たし、実用的な明細書の作成を提供します。
</role>

<context>
特許明細書の作成が必要です。法的要件を満たし、技術的詳細を正確に記載した明細書の作成が求められています。
</context>
```

---

## 2-8. プロンプトライブラリ（4）

#### 明細書作成テンプレート（続き）

```markdown
<task>
以下の発明について明細書を作成してください：

発明内容：[発明の詳細]
技術分野：[分野の詳細]
先行技術：[既存技術の状況]
課題：[解決すべき問題]
効果：[期待される効果]

以下の手順で段階的に作成してください：

1. まず、背景技術部分を作成
2. 次に、発明の概要を記載
3. そして、詳細な説明を追加
4. 最後に、実施例とクレームを記載
   </task>
```

---

## 2-8. プロンプトライブラリ（5）

#### 明細書作成テンプレート（2）

```markdown
<output_format>
出力形式：

- 特許庁要件準拠の構成
- 技術的詳細の記載
- 法的妥当性の確保
- 実用性の重視
  </output_format>

<constraints>
制約：
- 特許法の遵守
- 技術的精度
- 明確性の確保
- 実用性の重視
</constraints>
```

---

## 2-8. プロンプトライブラリ（6）

#### 分析・評価テンプレート

```markdown
<role>
あなたは特許分析・評価の専門家で、技術的観点と法的観点の両方から総合的な評価を専門としています。
客観的で実用的な分析結果を提供します。
</role>

<context>
特許技術の分析・評価が必要です。技術的新規性、実用性、市場性を総合的に評価することが求められています。
</context>
```

---

## 2-8. プロンプトライブラリ（7）

#### 分析・評価テンプレート（続き）

```markdown
<task>
以下の特許技術を分析・評価してください：

技術内容：[技術の詳細]
技術分野：[分野の詳細]
市場状況：[市場の状況]
競合状況：[競合の状況]

以下の手順で段階的に分析してください：

1. まず、技術的新規性を評価
2. 次に、実用性を分析
3. そして、市場性を評価
4. 最後に、総合評価を実施
   </task>
```

---

## 2-8. プロンプトライブラリ（8）

#### 分析・評価テンプレート（2）

```markdown
<output_format>
出力形式：

- 構造化された分析結果
- 定量的・定性的評価
- リスク・機会の分析
- 実用的な提案
  </output_format>

<constraints>
制約：
- 客観的な評価
- 具体的な根拠
- 実用性の重視
- 総合的な視点
</constraints>
```

---

## 2-9. プロンプトを生成させるプロンプト

#### プロンプト生成の基本概念

**プロンプト生成の重要性**

- **効率性の向上**: 手動でのプロンプト作成時間の短縮
- **品質の向上**: 体系的なプロンプト設計の実現
- **一貫性の確保**: 統一されたプロンプトスタイルの維持
- **学習効果**: プロンプト設計のベストプラクティスの習得

---

#### プロンプト生成用の基本テンプレート

```markdown
<role>
あなたはプロンプトエンジニアリングの専門家で、効果的なプロンプト設計と最適化に精通しています。
様々な業務分野に対応した高品質なプロンプトの作成を専門としています。
</role>

<context>
特定の業務やタスクに対応したプロンプトを作成する必要があります。
効率的で実用的なプロンプト設計が求められています。
</context>
```

---

```markdown
<task>
以下の要件でプロンプトを作成してください：

業務分野：[具体的な業務分野]
タスク内容：[実行したいタスク]
期待する出力：[期待する結果の形式]
制約条件：[考慮すべき制約]

以下の手順で段階的に作成してください：

1. まず、役割設定を定義
2. 次に、背景情報を整理
3. そして、具体的なタスクを設定
4. 最後に、出力形式と制約を定義
   </task>
```

---

```markdown
<output_format>
出力形式：

- 構造化されたプロンプト
- 明確な指示内容
- 実用的な制約
- 拡張可能な設計
  </output_format>

<constraints>
制約：
- 実用性の重視
- 明確性の確保
- 一貫性の維持
- 効果性の追求
</constraints>
```
